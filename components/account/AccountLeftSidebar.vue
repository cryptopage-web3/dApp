<template>
  <div class="profile-left2">
    <div class="profile-menu-wrap">
      <a href="#" class="profile-menu__oc">
        <img src="@/assets/img/profile-menu__oc_icon.svg" alt="" />
      </a>
      <div class="profile-menu-body">
        <a href="#" class="profile-menu-body__close">
          <img src="@/assets/img/market-main-filtr-oc__close_img.svg" alt="" />
        </a>
        <ul class="profile-menu__list">
          <li v-if="isAuth">
            <nuxt-link
              :to="`/${chainSlug}/${address}`"
              :class="{ active: isProfile }"
            >
              <div class="thumb">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M4.5 21H3.5C3.5 21.5523 3.94772 22 4.5 22V21ZM19.5 21V22C20.0523 22 20.5 21.5523 20.5 21H19.5ZM15 7C15 8.65685 13.6569 10 12 10V12C14.7614 12 17 9.76142 17 7H15ZM12 10C10.3431 10 9 8.65685 9 7H7C7 9.76142 9.23858 12 12 12V10ZM9 7C9 5.34315 10.3431 4 12 4V2C9.23858 2 7 4.23858 7 7H9ZM12 4C13.6569 4 15 5.34315 15 7H17C17 4.23858 14.7614 2 12 2V4ZM5.5 21C5.5 17.7728 8.59565 15 12 15V13C7.67236 13 3.5 16.4952 3.5 21H5.5ZM12 15C15.4044 15 18.5 17.7728 18.5 21H20.5C20.5 16.4952 16.3276 13 12 13V15ZM4.5 22H19.5V20H4.5V22Z"
                    fill="#687684"
                  />
                </svg>
              </div>
              <span> Profile </span>
            </nuxt-link>
          </li>
          <li v-if="isAuth">
            <a href="#">
              <div class="thumb">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M19 21L18.5528 21.8944C18.8628 22.0494 19.2309 22.0329 19.5257 21.8507C19.8205 21.6684 20 21.3466 20 21H19ZM5 21H4C4 21.3466 4.17945 21.6684 4.47427 21.8507C4.76909 22.0329 5.13723 22.0494 5.44721 21.8944L5 21ZM12 17.5L12.4472 16.6056C12.1657 16.4648 11.8343 16.4648 11.5528 16.6056L12 17.5ZM7 4H17V2H7V4ZM18 5V21H20V5H18ZM6 21V5H4V21H6ZM19.4472 20.1056L12.4472 16.6056L11.5528 18.3944L18.5528 21.8944L19.4472 20.1056ZM11.5528 16.6056L4.55279 20.1056L5.44721 21.8944L12.4472 18.3944L11.5528 16.6056ZM17 4C17.5523 4 18 4.44772 18 5H20C20 3.34315 18.6569 2 17 2V4ZM7 2C5.34315 2 4 3.34315 4 5H6C6 4.44772 6.44772 4 7 4V2Z"
                    fill="#687684"
                  />
                </svg>
              </div>
              <span> My favorites </span>
            </a>
          </li>
          <li v-if="isAuth">
            <a href="https://inbox.crypto.page/" target="_blank">
              <div class="thumb">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M7 14H8C8 13.4477 7.55228 13 7 13V14ZM7 18H6C6 18.4045 6.24364 18.7691 6.61732 18.9239C6.99099 19.0787 7.42111 18.9931 7.70711 18.7071L7 18ZM11 14V13C10.7348 13 10.4804 13.1054 10.2929 13.2929L11 14ZM17 18V17C16.4477 17 16 17.4477 16 18H17ZM17 22L16.2929 22.7071C16.5789 22.9931 17.009 23.0787 17.3827 22.9239C17.7564 22.7691 18 22.4045 18 22H17ZM13 18L13.7071 17.2929C13.5196 17.1054 13.2652 17 13 17V18ZM17 7C16.4477 7 16 7.44772 16 8C16 8.55228 16.4477 9 17 9V7ZM7.58579 17.4142L6.87868 16.7071H6.87868L7.58579 17.4142ZM5 5H15V3H5V5ZM16 6V12H18V6H16ZM4 12V6H2V12H4ZM7 13H5V15H7V13ZM8 18V14H6V18H8ZM15 13H11V15H15V13ZM2 12C2 13.6569 3.34315 15 5 15V13C4.44772 13 4 12.5523 4 12H2ZM16 12C16 12.5523 15.5523 13 15 13V15C16.6569 15 18 13.6569 18 12H16ZM15 5C15.5523 5 16 5.44772 16 6H18C18 4.34315 16.6569 3 15 3V5ZM5 3C3.34315 3 2 4.34315 2 6H4C4 5.44772 4.44772 5 5 5V3ZM22 16V10H20V16H22ZM17 19H19V17H17V19ZM18 22V18H16V22H18ZM9 19H13V17H9V19ZM12.2929 18.7071L16.2929 22.7071L17.7071 21.2929L13.7071 17.2929L12.2929 18.7071ZM20 16C20 16.5523 19.5523 17 19 17V19C20.6569 19 22 17.6569 22 16H20ZM19 9C19.5523 9 20 9.44772 20 10H22C22 8.34315 20.6569 7 19 7V9ZM19 7H17V9H19V7ZM6.87868 18.1213C7.42048 18.6631 8.17185 19 9 19V17C8.72358 17 8.47495 16.8892 8.29289 16.7071L6.87868 18.1213ZM10.2929 13.2929L6.87868 16.7071L8.29289 18.1213L11.7071 14.7071L10.2929 13.2929ZM6.87868 16.7071L6.29289 17.2929L7.70711 18.7071L8.29289 18.1213L6.87868 16.7071Z"
                    fill="#687684"
                  />
                </svg>
              </div>
              <span> Messages </span>
            </a>
          </li>
          <li v-if="isAuth">
            <nuxt-link to="/profile/settings" :class="{ active: isSettings }">
              <div class="thumb">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M7.75219 5.38285L8.27252 4.52888V4.52888L7.75219 5.38285ZM10.3246 4.31731L9.35285 4.08139L10.3246 4.31731ZM5.38285 7.75218L4.52888 8.27251H4.52888L5.38285 7.75218ZM4.31731 10.3246L4.08139 9.35285L4.31731 10.3246ZM4.31731 13.6754L4.55323 12.7036L4.31731 13.6754ZM5.38285 16.2478L4.52889 15.7275H4.52889L5.38285 16.2478ZM7.75219 18.6172L8.27252 19.4711L7.75219 18.6172ZM10.3246 19.6827L11.2964 19.4468L10.3246 19.6827ZM13.6754 19.6827L14.6471 19.9186L13.6754 19.6827ZM16.2478 18.6172L15.7275 19.4711L16.2478 18.6172ZM18.6172 16.2478L19.4711 15.7275L18.6172 16.2478ZM19.6827 13.6754L19.9186 14.6471L19.6827 13.6754ZM19.6827 10.3246L19.4468 11.2964L19.6827 10.3246ZM18.6172 7.75218L19.4711 8.27251L18.6172 7.75218ZM16.2478 5.38285L15.7275 4.52888V4.52888L16.2478 5.38285ZM13.6754 4.31731L12.7036 4.55323L13.6754 4.31731ZM7.23186 6.23681C8.80726 7.19673 10.8612 6.34596 11.2964 4.55322L9.35285 4.08139C9.23717 4.55789 8.69125 4.78402 8.27252 4.52888L7.23186 6.23681ZM6.23681 7.23185C5.84185 6.58365 6.58365 5.84185 7.23186 6.23681L8.27252 4.52888C5.83376 3.04292 3.04293 5.83376 4.52888 8.27251L6.23681 7.23185ZM4.55322 11.2964C6.34596 10.8612 7.19673 8.80726 6.23681 7.23185L4.52888 8.27251C4.78402 8.69125 4.5579 9.23717 4.08139 9.35285L4.55322 11.2964ZM4.55323 12.7036C3.81559 12.5245 3.81559 11.4755 4.55322 11.2964L4.08139 9.35285C1.3062 10.0266 1.3062 13.9734 4.08139 14.6471L4.55323 12.7036ZM6.23682 16.7681C7.19673 15.1927 6.34596 13.1388 4.55323 12.7036L4.08139 14.6471C4.5579 14.7628 4.78402 15.3088 4.52889 15.7275L6.23682 16.7681ZM7.23186 17.7632C6.58365 18.1581 5.84186 17.4164 6.23682 16.7681L4.52889 15.7275C3.04293 18.1662 5.83376 20.9571 8.27252 19.4711L7.23186 17.7632ZM11.2964 19.4468C10.8612 17.654 8.80726 16.8033 7.23186 17.7632L8.27252 19.4711C8.69125 19.216 9.23717 19.4421 9.35285 19.9186L11.2964 19.4468ZM12.7036 19.4468C12.5245 20.1844 11.4755 20.1844 11.2964 19.4468L9.35285 19.9186C10.0266 22.6938 13.9734 22.6938 14.6471 19.9186L12.7036 19.4468ZM16.7681 17.7632C15.1927 16.8033 13.1388 17.654 12.7036 19.4468L14.6471 19.9186C14.7628 19.4421 15.3088 19.216 15.7275 19.4711L16.7681 17.7632ZM17.7632 16.7681C18.1581 17.4164 17.4164 18.1581 16.7681 17.7632L15.7275 19.4711C18.1662 20.9571 20.9571 18.1662 19.4711 15.7275L17.7632 16.7681ZM19.4468 12.7036C17.654 13.1388 16.8033 15.1927 17.7632 16.7681L19.4711 15.7275C19.216 15.3088 19.4421 14.7628 19.9186 14.6471L19.4468 12.7036ZM19.4468 11.2964C20.1844 11.4755 20.1844 12.5245 19.4468 12.7036L19.9186 14.6471C22.6938 13.9734 22.6938 10.0266 19.9186 9.35285L19.4468 11.2964ZM17.7632 7.23185C16.8033 8.80726 17.654 10.8612 19.4468 11.2964L19.9186 9.35285C19.4421 9.23717 19.216 8.69125 19.4711 8.27251L17.7632 7.23185ZM16.7681 6.23682C17.4164 5.84185 18.1581 6.58364 17.7632 7.23185L19.4711 8.27251C20.9571 5.83376 18.1662 3.04293 15.7275 4.52888L16.7681 6.23682ZM12.7036 4.55323C13.1388 6.34596 15.1927 7.19673 16.7681 6.23682L15.7275 4.52888C15.3088 4.78402 14.7628 4.5579 14.6471 4.08139L12.7036 4.55323ZM14.6471 4.08139C13.9734 1.3062 10.0266 1.3062 9.35285 4.08139L11.2964 4.55322C11.4755 3.81559 12.5245 3.81559 12.7036 4.55323L14.6471 4.08139ZM14 12C14 13.1046 13.1046 14 12 14V16C14.2091 16 16 14.2091 16 12H14ZM12 14C10.8954 14 10 13.1046 10 12H8C8 14.2091 9.79086 16 12 16V14ZM10 12C10 10.8954 10.8954 10 12 10V8C9.79086 8 8 9.79086 8 12H10ZM12 10C13.1046 10 14 10.8954 14 12H16C16 9.79086 14.2091 8 12 8V10Z"
                    fill="#687684"
                  />
                </svg>
              </div>
              <span> Settings </span>
            </nuxt-link>
          </li>
          <li>
            <a href="#">
              <div class="thumb">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M5 4C3.34315 4 2 5.34315 2 7V17C2 18.6569 3.34315 20 5 20C6.65685 20 8 18.6569 8 17V7C8 5.34315 6.65685 4 5 4ZM5 6C4.44772 6 4 6.44772 4 7V17C4 17.5523 4.44772 18 5 18C5.55228 18 6 17.5523 6 17V7C6 6.44772 5.55228 6 5 6Z"
                    fill="#687684"
                  />
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M12 4C10.3431 4 9 5.34315 9 7V17C9 18.6569 10.3431 20 12 20C13.6569 20 15 18.6569 15 17V7C15 5.34315 13.6569 4 12 4ZM12 6C11.4477 6 11 6.44772 11 7V17C11 17.5523 11.4477 18 12 18C12.5523 18 13 17.5523 13 17V7C13 6.44772 12.5523 6 12 6Z"
                    fill="#687684"
                  />
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M19 4C17.3431 4 16 5.34315 16 7V17C16 18.6569 17.3431 20 19 20C20.6569 20 22 18.6569 22 17V7C22 5.34315 20.6569 4 19 4ZM19 6C18.4477 6 18 6.44772 18 7V17C18 17.5523 18.4477 18 19 18C19.5523 18 20 17.5523 20 17V7C20 6.44772 19.5523 6 19 6Z"
                    fill="#687684"
                  />
                </svg>
              </div>
              <span> Spaces </span>
              <mark> Comming Soon </mark>
            </a>
          </li>
          <li>
            <a href="#">
              <div class="thumb">
                <svg
                  width="24"
                  class="stroke"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M17 14V20M14 17H20M6 10H8C9.10457 10 10 9.10457 10 8V6C10 4.89543 9.10457 4 8 4H6C4.89543 4 4 4.89543 4 6V8C4 9.10457 4.89543 10 6 10ZM16 10H18C19.1046 10 20 9.10457 20 8V6C20 4.89543 19.1046 4 18 4H16C14.8954 4 14 4.89543 14 6V8C14 9.10457 14.8954 10 16 10ZM6 20H8C9.10457 20 10 19.1046 10 18V16C10 14.8954 9.10457 14 8 14H6C4.89543 14 4 14.8954 4 16V18C4 19.1046 4.89543 20 6 20Z"
                    stroke="#687684"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <span> Mini apps </span>
              <mark> Comming Soon </mark>
            </a>
          </li>
          <li>
            <a href="#">
              <div class="thumb">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M16.1667 4H7.83333C6.28628 4 4.80248 4.57344 3.70852 5.59418C2.61457 6.61491 2 7.99941 2 9.44292V16.1083C1.99851 17.4053 2.69048 18.6177 3.84486 19.3405C4.99924 20.0633 6.46371 20.2012 7.74962 19.7085C9.03552 19.2157 9.97337 18.157 10.25 16.8859H13.75C14.0266 18.157 14.9645 19.2158 16.2504 19.7085C17.5363 20.2012 19.0007 20.0632 20.1551 19.3405C21.3095 18.6176 22.0015 17.4053 22 16.1083V9.44292C22 7.99941 21.3854 6.61491 20.2915 5.59418C19.1975 4.57344 17.7137 4 16.1667 4ZM20.3333 16.1083C20.3333 16.9417 19.8567 17.7118 19.0833 18.1284C18.3099 18.5451 17.3567 18.5451 16.5833 18.1284C15.8099 17.7118 15.3333 16.9417 15.3333 16.1083C15.3333 15.9021 15.2455 15.7042 15.0893 15.5584C14.933 15.4126 14.721 15.3307 14.5 15.3307H9.49999C9.27901 15.3307 9.06696 15.4126 8.91071 15.5584C8.75446 15.7042 8.66666 15.9021 8.66666 16.1083C8.66666 16.9417 8.19009 17.7118 7.41666 18.1284C6.64324 18.5451 5.69009 18.5451 4.91667 18.1284C4.14324 17.7118 3.66667 16.9417 3.66667 16.1083V9.44292C3.66667 8.41179 4.10566 7.423 4.88709 6.69387C5.66853 5.96474 6.72824 5.55512 7.83333 5.55512H16.1667C17.2717 5.55512 18.3315 5.96473 19.1129 6.69387C19.8943 7.42301 20.3333 8.41179 20.3333 9.44292V16.1083Z"
                    fill="#687684"
                  />
                  <path
                    d="M19 10C19 10.5522 18.5522 11 18 11C17.4478 11 17 10.5522 17 10C17 9.44777 17.4478 9 18 9C18.5522 9 19 9.44777 19 10Z"
                    fill="#687684"
                  />
                  <path
                    d="M17 8C17 8.55223 16.5522 9 16 9C15.4478 9 15 8.55223 15 8C15 7.44777 15.4478 7 16 7C16.5522 7 17 7.44777 17 8Z"
                    fill="#687684"
                  />
                  <path
                    d="M17 12C17 12.5522 16.5522 13 16 13C15.4478 13 15 12.5522 15 12C15 11.4478 15.4478 11 16 11C16.5522 11 17 11.4478 17 12Z"
                    fill="#687684"
                  />
                  <path
                    d="M15 10C15 10.5522 14.5522 11 14 11C13.4478 11 13 10.5522 13 10C13 9.44777 13.4478 9 14 9C14.5522 9 15 9.44777 15 10Z"
                    fill="#687684"
                  />
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M7 8C7 7.44772 7.44772 7 8 7C8.55228 7 9 7.44772 9 8V9H10C10.5523 9 11 9.44772 11 10C11 10.5523 10.5523 11 10 11H9V12C9 12.5523 8.55228 13 8 13C7.44772 13 7 12.5523 7 12V11H6C5.44772 11 5 10.5523 5 10C5 9.44772 5.44772 9 6 9H7V8ZM8 11C8.55223 11 9 10.5522 9 10C9 9.44777 8.55223 9 8 9C7.44777 9 7 9.44777 7 10C7 10.5522 7.44777 11 8 11Z"
                    fill="#687684"
                  />
                </svg>
              </div>
              <span> Games </span>
              <mark> Comming Soon </mark>
            </a>
          </li>
          <li>
            <a href="#" class="night-mode-link">
              <div class="thumb">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M9.37 5.51C9.18938 6.15786 9.09853 6.82744 9.1 7.5C9.1 11.58 12.42 14.9 16.5 14.9C17.18 14.9 17.85 14.81 18.49 14.63C17.9647 15.9207 17.0668 17.0257 15.9109 17.804C14.7551 18.5823 13.3935 18.9987 12 19C8.14 19 5 15.86 5 12C5 9.07 6.81 6.55 9.37 5.51ZM12 3C10.22 3 8.47991 3.52784 6.99987 4.51677C5.51983 5.50571 4.36628 6.91131 3.68509 8.55585C3.0039 10.2004 2.82567 12.01 3.17294 13.7558C3.5202 15.5016 4.37737 17.1053 5.63604 18.364C6.89472 19.6226 8.49836 20.4798 10.2442 20.8271C11.99 21.1743 13.7996 20.9961 15.4442 20.3149C17.0887 19.6337 18.4943 18.4802 19.4832 17.0001C20.4722 15.5201 21 13.78 21 12C21 11.54 20.96 11.08 20.9 10.64C20.4003 11.3407 19.7401 11.9115 18.9746 12.3047C18.2091 12.6978 17.3606 12.902 16.5 12.9C15.3552 12.9 14.24 12.5364 13.3152 11.8617C12.3904 11.1869 11.7038 10.2358 11.3545 9.14561C11.0052 8.05541 11.0112 6.88243 11.3717 5.79586C11.7321 4.70928 12.4284 3.76528 13.36 3.1C12.92 3.04 12.46 3 12 3Z"
                    fill="#687684"
                  />
                </svg>
              </div>
              <span> Night Mode </span>
              <div class="checkbox-of">
                <div></div>
              </div>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</template>

<script lang="ts">
import Vue from 'vue';
import { Component, Watch } from 'nuxt-property-decorator';
import { accountLeftSidebarInit } from '~/utils/accountLeftSidebar';
import { leftStickySidebarInit } from '~/utils/leftStickySidebar';
import { authModule, addressModule, stickyModule } from '~/store';

@Component({})
export default class AccountLeftSidebar extends Vue {
  stickySidebar: any = null;
  timeout: any = null;

  get refresh() {
    return stickyModule.leftRefresh;
  }

  get isProfile(): boolean {
    return this.$route.name === 'network-address' && this.isOwner;
  }

  get isSettings(): boolean {
    return this.$route.name === 'profile-settings';
  }

  get isAuth(): boolean {
    return authModule.isAuth;
  }

  get address(): string {
    return authModule.address;
  }

  get chainSlug(): string {
    return authModule.chainSlug;
  }

  get isOwner(): boolean {
    return (
      authModule.address.toLowerCase() ===
        addressModule.address.toLowerCase() &&
      authModule.chainSlug === addressModule.chainSlug
    );
  }

  @Watch('$route')
  onRouteChanged() {
    this.refreshSticky();
  }

  @Watch('refresh')
  onRefreshChange(refresh: boolean) {
    if (!refresh) {
      return;
    }

    this.refreshSticky();
    stickyModule.cleanLeft();
  }

  mounted() {
    accountLeftSidebarInit();

    setTimeout(() => {
      this.stickySidebar = leftStickySidebarInit();
    }, 100);
  }

  refreshSticky() {
    this.timeout && clearTimeout(this.timeout);

    this.timeout = setTimeout(() => {
      this.stickySidebar && this.stickySidebar.destroy();
      const elements = $('.profile-left2 .inner-wrapper-sticky > *');
      $('.profile-menu-wrap').append(elements);
      $('.profile-left2 .inner-wrapper-sticky').remove();

      this.$nextTick(() => {
        this.stickySidebar = leftStickySidebarInit();
      });
    }, 500);
  }
}
</script>
